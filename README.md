# Blind-SEFA


This repository contains the documentation of our simulations and Expriments on Blind-SEFA

---

* [Simulation](https://github.com/Navidvafaei/Blind-sefa#simulation)
* [Practical_Attacks](https://github.com/Navidvafaei/Blind-sefa#practical_attack)
  * [Simulated_HW](https://github.com/Navidvafaei/Blind-sefa#simulated_hw)


## Simulation

**Initialization**

```
 close all;
load('s_box.mat');

no_bits =8;
fb=8;%no.faulty bits
sigma = 0.7;
no_traces = 110000;
range = 2^no_bits-1;

K=0:range;
A=0:no_bits;
B=0:no_bits;

cardK = length(K);
cardA = length(A);
cardB = length(B);
pr_uni = 1/cardK;
```
Fault Distribution during the **Fault profiling** is generated by following code:

```

Distribution_SIFA = zeros(cardB, cardK);
Distribution_SEFA1 = zeros(cardB, cardK);
Distribution_SEFA2 = zeros(cardA, cardB, cardK);

for k=K
    for a=0:255
        for f=0:2^(fb)-1
            % compute the discrete part of the leakage function 
            faultvalue=bitxor((256-(2^fb)),f);
            b=bitand(a,faultvalue);
            hc=Hamming(bitxor(s_box(a+1),k)); %%%%**Correct Output**
            hf =Hamming(bitxor(s_box(b+1),k));
            hd=Hamming(bitxor(s_box(b+1),s_box(a+1)));
            % compute the joint distribution for every k
            if (b)==(a)
                Distribution_SIFA(hf+1, k+1) = Distribution_SIFA(hf+1, k+1) + pr_uni;
            else
                Distribution_SEFA1(hf+1, k+1) = Distribution_SEFA1(hf+1, k+1) + pr_uni;
                Distribution_SEFA2( hc+1, hd+1, k+1) = Distribution_SEFA2( hc+1, hd+1, k+1) + (pr_uni);
            end
        end
    end
end

```

--- 
%in this formula hf is calculated once for SEFA1 and also can be  distance of HW(c+c')

## Practical_Attack

 <img src="https://user-images.githubusercontent.com/30938963/199026183-dd10d4a7-6fd3-4711-8d65-10e594688304.png" alt="Your image title" width="700"/>



### Simulated_HW






